<%- include("partials/_header") %>

  <body style="background-color: #e3f2fd;">

    <div class="container d-flex justify-content-center"
      style="max-width: 1000px; flex-direction: column; align-items: center;">


      <h1 class="mt-3">Create Prescription</h1>
      <h3>
        <%= patient.patient_name %> - <%= patient.patient_gender %>/<%= patient.patient_age %> yr
      </h3>


      <!-- Horizontal buttons for switching tabs -->
      <div class="btn-group mt-4" role="group">
        <button type="button" class="btn btn-secondary active" onclick="openTab('tab1')" id="tab1Button">Case
          History</button>
        <button type="button" class="btn btn-secondary" onclick="openTab('tab2')"
          id="tab2Button">Medicine/Product</button>
        <button type="button" class="btn btn-secondary" onclick="openTab('tab3')" id="tab3Button">Lab
          Test/Imaging</button>
      </div>

      <!-- Single form with all fields -->
      <form id="mainForm" action="/prescribe" method="post">

        <!-- Hidden input for patient_id -->
        <input type="hidden" id="patient_id" name="patient_id" value="<%= patient.patient_id %>">


        <!-- Tab 1: Case History -->
        <div id="tab1" class="tab-content mt-3" style="display: block;">

          <!-- Row for Temperature, Height, and Weight -->
          <div class="row gx-2">
            <!-- Temperature -->
            <div class="col-md-4">
              <div class="form-floating">
                <input type="text" id="temperature" name="temperature" class="form-control" placeholder="temperature">
                <label for="temperature">Temperature</label>
              </div>
            </div>

            <!-- Height -->
            <div class="col-md-4">
              <div class="form-floating">
                <input type="text" id="height" name="height" class="form-control" placeholder="height">
                <label for="height">Height</label>
              </div>
            </div>

            <!-- Weight -->
            <div class="col-md-4">
              <div class="form-floating">
                <input type="text" id="weight" name="weight" class="form-control" placeholder="weight">
                <label for="weight">Weight</label>
              </div>
            </div>
          </div>

          <!-- Row for Pulse, Blood Sugar, Allergy, and SpO2 -->
          <div class="row mt-2 gx-2">
            <!-- Pulse -->
            <div class="col-md-4">
              <div class="form-floating">
                <input type="text" id="pulse" name="pulse" class="form-control" placeholder="pulse">
                <label for="pulse">Pulse</label>
              </div>
            </div>

            <!-- Allergy -->
            <div class="col-md-4">
              <div class="form-floating">
                <input type="text" id="bloodSugar" name="bloodSugar" class="form-control" placeholder="bloodSugar">
                <label for="bloodSugar">Blood Sugar</label>
              </div>
            </div>

            <!-- SpO2 -->
            <div class="col-md-4">
              <div class="form-floating">
                <input type="text" id="spo2" name="spo2" class="form-control" placeholder="spo2">
                <label for="spo2">SpO2</label>
              </div>
            </div>
          </div>

          <div class="row mt-2 gx-2">
            <div class="col-md-4">
              <div class="form-floating">
                <input type="text" id="bloodPressure" name="bloodPressure" class="form-control" placeholder="bloodPressure">
                <label for="bloodPressure">Blood Pressure</label>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-floating">
                <input type="text" id="haemoglobin" name="haemoglobin" class="form-control" placeholder="haemoglobin">
                <label for="haemoglobin">Haemoglobin</label>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-floating">
                <input type="text" id="respirationRate" name="respirationRate" class="form-control" placeholder="respirationRate">
                <label for="respirationRate">Respiration Rate</label>
              </div>
            </div>
          </div>

          <div class="form-floating mt-2">
            <input type="text" id="allergy" name="allergy" class="form-control" placeholder="allergy">
            <label for="allergy">Allergy</label>
          </div>

          <!-- Chief Complaint -->
          <div class="form-floating mt-2">
            <input type="text" id="chiefComplaint" name="chiefComplaint" class="form-control" placeholder="chiefComplaint">
            <label for="chiefComplaint">Chief Complaint</label>
          </div>

          <!-- History -->
          <div class="form-floating mt-2">
            <input type="text" id="history" name="history" class="form-control" placeholder="history">
            <label for="history">History</label>
          </div>

          <!-- Findings -->
          <div class="form-floating mt-2">
            <input type="text" id="findings" name="findings" class="form-control" placeholder="findings">
            <label for="findings">Findings</label>
          </div>

          <!-- Diagnosis -->
          <div class="form-floating mt-2">
            <input type="text" id="diagnosis" name="diagnosis" class="form-control" placeholder="diagnosis">
            <label for="diagnosis">Diagnosis</label>
          </div>

          <!-- Treatment/Advice -->
          <div class="form-floating mt-2">
            <input type="text" id="treatmentAdvice" name="treatmentAdvice" class="form-control" placeholder="treatmentAdvice">
            <label for="treatmentAdvice">Treatment/Advice</label>
          </div>

          <!-- End Note -->
          <div class="form-floating mt-2">
            <input type="text" id="endNote" name="endNote" class="form-control" placeholder="endNote">
            <label for="endNote">End Note</label>
          </div>
        </div>

        <!-- Tab 2: Medicine/Product -->
        <div id="tab2" class="tab-content mt-3">

          <div id="medicineFields" class="medicine-fields">
            <div class="medicine-field-group form-floating">
              <div class="row gx-2">
                <div class="col-md-4">
                  <div class="form-floating">
                    <input type="text" id="medicineName[]" name="medicineName" class="form-control" placeholder="medicineName">
                    <label for="medicineName">Name of Medicine</label>
                  </div>
                </div>

                <div class="col-md-4 mb-2">
                  <div class="form-floating">
                    <input type="text" id="quantity[]" name="quantity" class="form-control" placeholder="quantity">
                    <label for="quantity">T. Qty</label>
                  </div>
                </div>

                <div class="col-md-4 mb-2">
                  <div class="form-floating">
                    <input type="text" id="price[]" name="price" class="form-control" placeholder="price">
                    <label for="price">Timings</label>
                  </div>
                </div>

              </div>
            </div>
          </div>

          <div class="container d-flex justify-content-center"
            style="max-width: 900px; flex-direction: row; align-items: center;">
            <button class="btn custom-btn-style-left" type="button" onclick="addMedicineField()">Add Medicine</button>
            <button class="btn custom-btn-style-right" type="button" onclick="removeLastMedicineField()">Remove
              Medicine</button>
          </div>

          <div class="row mt-4 gx-2">
            <div class="col-md-6">
              <div class="form-floating">
                <input type="text" id="frequency" name="frequency" class="form-control" placeholder="frequency">
                <label for="frequency">Frequency</label>
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-floating">
                <input type="text" id="route" name="route" class="form-control" placeholder="route">
                <label for="route">Route/Form</label>
              </div>
            </div>
          </div>

          <div class="row mt-2 gx-2">
            <div class="col-md-6">
              <div class="form-floating">
                <input type="text" id="numberOfDays" name="numberOfDays" class="form-control" placeholder="numberOfDays">
                <label for="numberOfDays">No. of days</label>
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-floating">
                <input type="text" id="instructions" name="instructions" class="form-control" placeholder="instructions">
                <label for="instructions">Instructions</label>
              </div>
            </div>
          </div>

          <div class="form-floating mt-2">
            <input type="text" id="additionalComments" name="additionalComments" class="form-control" placeholder="additionalComments">
            <label for="additionalComments">Additional Comments</label>
          </div>
        </div>

        <!-- Tab 3: Lab Test/Imaging -->
        <div id="tab3" class="tab-content mt-3">
          <div id="labTestFields" class="lab-test-fields">
            <div class="lab-test-field-group">
              <div class="form-floating mb-2">
                <input type="text" id="labTestName[]" name="labTestName" class="form-control" placeholder="labTestName">
                <label for="labTestName">Name of Lab Test/Imaging:</label>
              </div>
            </div>
          </div>

          <div class="container d-flex justify-content-center"
            style="max-width: 900px; flex-direction: row; align-items: center;">
            <button class="btn custom-btn-style-left" type="button" onclick="addLabTestField()">Add Lab Test</button>
            <button class="btn custom-btn-style-right" type="button" onclick="removeLastLabTestField()">Remove Lab
              Test</button>
          </div>

          <div class="form-floating mt-4">
            <input type="text" id="labTestComments" name="labTestComments" class="form-control" placeholder="labTestComments">
            <label for="labTestComments">Additional Comments</label>
          </div>

          <div class="dropdown mt-4">
            <button class="btn btn-secondary dropdown-toggle" style="width: 100%;" type="button" data-bs-toggle="dropdown" aria-expanded="false">
              Panchakarma
            </button>
            <ul class="dropdown-menu" style="width: 100%;">
              <li class="list-group-item" style="margin-left: 20px; margin-top: 3px;">
                <input class="form-check-input me-1" type="checkbox" value="Vamana" name="panchakarma" id="panchakarma[]">
                <label class="form-check-label" for="panchakarma">Vamana</label>
              </li>
              <li class="list-group-item" style="margin-left: 20px; margin-top: 3px;">
                <input class="form-check-input me-1" type="checkbox" value="Virechana" name="panchakarma" id="panchakarma[]">
                <label class="form-check-label" for="panchakarma">Virechana</label>
              </li>
              <li class="list-group-item" style="margin-left: 20px; margin-top: 3px;">
                <input class="form-check-input me-1" type="checkbox" value="Nasya" name="panchakarma" id="panchakarma[]">
                <label class="form-check-label" for="panchakarma">Nasya</label>
              </li>
              <li class="list-group-item" style="margin-left: 20px; margin-top: 3px;">
                <input class="form-check-input me-1" type="checkbox" value="Basti" name="panchakarma" id="panchakarma[]">
                <label class="form-check-label" for="panchakarma">Basti</label>
              </li>
              <li class="list-group-item" style="margin-left: 20px; margin-top: 3px;">
                <input class="form-check-input me-1" type="checkbox" value="Raktamochana" name="panchakarma" id="panchakarma[]">
                <label class="form-check-label" for="panchakarma">Raktamochana</label>
              </li>
            </ul>
          </div>
        </div>

        <div class="container d-flex justify-content-center"
          style="max-width: 900px; flex-direction: row; align-items: center;">
          <button type="submit" class="btn btn-primary mt-3">Prescribe</button>
        </div>
      </form>

    </div>
    </div>

  </body>

  </html>


  <script>
    // Script to simulate a click on the "Case History" tab on page load
    document.addEventListener("DOMContentLoaded", function () {
      openTab('tab1');
    });

    function openTab(tabName) {
      var i, tabContent;
      tabContent = document.getElementsByClassName("tab-content");
      for (i = 0; i < tabContent.length; i++) {
        tabContent[i].style.display = "none";
      }
      document.getElementById(tabName).style.display = "block";

      // Remove 'active' class from all buttons
      var tabButtons = document.querySelectorAll('.btn-group .btn');
      tabButtons.forEach(function (button) {
        button.classList.remove('active');
      });

      // Add 'active' class to the clicked button
      var activeButton = document.getElementById(tabName + 'Button');
      activeButton.classList.add('active');
    }

    function addMedicineField() {
      var medicineFields = document.getElementById('medicineFields');
      var newMedicineFieldGroup = document.createElement('div');
      newMedicineFieldGroup.classList.add('medicine-field-group');

      newMedicineFieldGroup.innerHTML = `
      <div class="row gx-2">
        <div class="col-md-4">
          <div class="form-floating">
            <input type="text" id="medicineName[]" name="medicineName" class="form-control" placeholder="medicineName">
            <label for="medicineName">Name of Medicine</label>
          </div>
        </div>

        <div class="col-md-4 mb-2">
          <div class="form-floating">
            <input type="text" id="quantity[]" name="quantity" class="form-control" placeholder="quantity">
            <label for="quantity">T. Qty:</label>
          </div>
        </div>

        <div class="col-md-4 mb-2">
          <div class="form-floating">
            <input type="text" id="price[]" name="price" class="form-control" placeholder="price">
            <label for="price">Price</label>
          </div>
        </div>
      </div>
    `;

      medicineFields.appendChild(newMedicineFieldGroup);
    }

    function removeLastMedicineField() {
      var medicineFields = document.getElementById('medicineFields');
      var lastMedicineField = medicineFields.lastElementChild;

      if (lastMedicineField) {
        medicineFields.removeChild(lastMedicineField);
      }
    }

    function addLabTestField() {
      var labTestFields = document.getElementById('labTestFields');
      var newLabTestFieldGroup = document.createElement('div');
      newLabTestFieldGroup.classList.add('lab-test-field-group');

      newLabTestFieldGroup.innerHTML = `
        <div class="form-floating mb-2">
          <input type="text" id="labTestName[]" name="labTestName" class="form-control"  placeholder="labTestName">
          <label for="labTestName">Name of Lab Test/Imaging:</label>
        </div>
    `;

      labTestFields.appendChild(newLabTestFieldGroup);
    }

    function removeLastLabTestField() {
      var labTestFields = document.getElementById('labTestFields');
      var lastLabTestField = labTestFields.lastElementChild;

      if (lastLabTestField) {
        labTestFields.removeChild(lastLabTestField);
      }
    }

  </script>

  <style>
    /* Custom styling for active tab button */
    .btn.active {
      background-color: black;
      color: white;
    }

    .custom-btn-style-left {
      background-color: #EAEBEC;
      /* Your preferred background color */
      color: #2FAEF7;
      /* Your preferred text color */
      border: none;
      /* Remove default button border */
      border-radius: 20px;
      /* Adjust border-radius for roundness */
      padding: 5px 15px;
      font-size: 10px;
      margin-top: 5px;
      /* Add top margin */
      margin-bottom: 5px;
      /* Add bottom margin */
      display: block;
      /* Center the button */
      margin-left: 50px;
      margin-right: 10px;
    }

    .custom-btn-style-right {
      background-color: #EAEBEC;
      /* Your preferred background color */
      color: #2FAEF7;
      /* Your preferred text color */
      border: none;
      /* Remove default button border */
      border-radius: 20px;
      /* Adjust border-radius for roundness */
      padding: 5px 15px;
      font-size: 10px;
      margin-top: 5px;
      /* Add top margin */
      margin-bottom: 5px;
      /* Add bottom margin */
      display: block;
      /* Center the button */
      margin-left: 10px;
      margin-right: 50px;
    }

    


  </style>